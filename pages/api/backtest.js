const Papa = require('papaparse'); const fs = require('fs'); const path = require('path');
export default async function handler(req,res){ try{ if(req.method!=='POST') return res.status(405).end(); const {symbol, from, to} = req.body; const csv = fs.readFileSync(path.join(process.cwd(),'data','reliance.csv'),'utf8'); const parsed = Papa.parse(csv, {header:true}).data; const prices = parsed.map(r=>({date:r.Date, close:parseFloat(r.Close)})).filter(r=>r.close); const first = prices[0], last=prices[prices.length-1]; const ret = ((last.close-first.close)/first.close)*100; return res.json({ok:true, summary:{return_percent:ret.toFixed(2)}, trades:[{type:'buy_hold', entry:first, exit:last}]}); } catch(e){ console.error(e); res.status(500).json({ok:false,error:e.message}); } }
